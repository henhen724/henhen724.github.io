import { graphQuery } from './comms'

export async function request(personaId: string, returnUrl: string, state: string = null, lifespan: number = 86400) {
  return await graphQuery(
    `
    mutation CreatePersonaVerificationRequest($personaId: String!, $returnUrl: String!, $state: String, $lifespan: Int) {
      createPersonaVerificationRequest(personaId: $personaId, returnUrl: $returnUrl, state: $state, lifespan: $lifespan) {
        personaId
        expiresAt
        verificationUrl
      }
    }
    `, {
      personaId,
      returnUrl,
      lifespan,
      state
    }, (data: any) => data.createPersonaVerificationRequest
  )
}
